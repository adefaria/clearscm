#!/bin/bash
export PATH=$PATH:/sbin:/usr/sbin

logfile=/var/local/log/update-system.log
tmpfile=/tmp/update-system.list

apt-get update -y > /dev/null 2>&1

apt-gt list --upgradeable > $tmpfile
uptodate=$(grep -v "^Listing" $tmpfile | wc -l)

if [ $uptodate -ne 0 ]; then
  cat $tmpfile >> $logfile && rm $tmpfile
  
  apt-get upgrade    -y >> /dev/null 2>&1
  apt-get autoremove -y >> /dev/null 2>&1

  echo "$(date): Updated $HOSTNAME" >> $logfile
else
  rm $tmpfile

  echo "$(date): No updates for $HOSTNAME" >> $logfile
fi
